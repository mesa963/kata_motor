<div class="app-container">

  <div class="card-left">
    <div class="card-header">
      <h2>Código Fuente</h2>
      <p>Ingresa tu código legacy COBOL</p>
    </div>

    <div class="editor-container">
      <textarea class="code-editor" [(ngModel)]="codigoLegado" placeholder="Ingresa tu código legacy COBOL"></textarea>
    </div>

    <div class="card-footer">
      <div class="lang-selector">
        <label>Lenguaje Destino</label>
        <select [(ngModel)]="lenguajeDestino">
          <option value="Java + Spring Boot">Java + Spring Boot</option>
        </select>
      </div>

      <button class="btn-primary" (click)="ejecutarMigracion()" [disabled]="isGenerando() || !codigoLegado()">
        <svg *ngIf="!isGenerando()" xmlns="http://www.w3.org/2001/svg" width="16" height="16" viewBox="0 0 24 24"
          fill="currentColor">
          <path d="M8 5v14l11-7z" />
        </svg>
        <span *ngIf="isGenerando()" class="spinner"></span>
        {{ isGenerando() ? 'Migrando...' : 'Ejecutar Migración' }}
      </button>
    </div>
  </div>

  <div class="card-right">
    <div class="tabs">
      <button class="tab" [class.active]="tabSeleccionada() === 'codigo'" (click)="setTab('codigo')">
        <svg xmlns="http://www.w3.org/2001/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <polyline points="16 18 22 12 16 6"></polyline>
          <polyline points="8 6 2 12 8 18"></polyline>
        </svg>
        Código Migrado
      </button>
      <button class="tab" [class.active]="tabSeleccionada() === 'reporte'" (click)="setTab('reporte')">
        <svg xmlns="http://www.w3.org/2001/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="16" y1="13" x2="8" y2="13"></line>
          <line x1="16" y1="17" x2="8" y2="17"></line>
          <polyline points="10 9 9 9 8 9"></polyline>
        </svg>
        Reporte
      </button>
    </div>

    <!-- Código Migrado Tab -->
    <div class="tab-content" *ngIf="tabSeleccionada() === 'codigo'">
      <div class="editor-container full-height">
        <textarea class="code-editor" readonly [value]="codigoModerno()"></textarea>
      </div>
    </div>

    <!-- Reporte Tab -->
    <div class="tab-content reporte-content" *ngIf="tabSeleccionada() === 'reporte'">

      <!-- Reglas Aplicadas -->
      <div class="report-section green-section">
        <h3 class="section-title">
          <svg xmlns="http://www.w3.org/2001/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="#059669" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          Reglas Aplicadas
        </h3>

        <div class="empty-state" *ngIf="reglasAplicadas().length === 0">
          No hay reglas aplicadas todavía.
        </div>

        <div class="rule-item" *ngFor="let regla of reglasAplicadas()">
          <svg xmlns="http://www.w3.org/2001/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          {{ regla }}
        </div>
      </div>

      <!-- Warnings Detectados -->
      <div class="report-section orange-section">
        <h3 class="section-title">
          <svg xmlns="http://www.w3.org/2001/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
            stroke="#d97706" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          Warnings Detectados
        </h3>

        <div class="empty-state" *ngIf="advertencias().length === 0">
          No hay warnings reportados.
        </div>

        <div class="warning-item" *ngFor="let warning of advertencias()">
          <svg xmlns="http://www.w3.org/2001/svg" width="16" height="16" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
            <line x1="12" y1="9" x2="12" y2="13"></line>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          {{ warning }}
        </div>
      </div>

    </div>
  </div>
</div>